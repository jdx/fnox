{
  "$defs": {
    "BitwardenBackend": {
      "enum": ["bw", "rbw"],
      "type": "string"
    },
    "IfMissing": {
      "enum": ["error", "warn", "ignore"],
      "type": "string"
    },
    "OptionStringOrSecretRef": {
      "anyOf": [
        {
          "$ref": "#/$defs/StringOrSecretRef"
        },
        {
          "type": "null"
        }
      ],
      "description": "An optional value that can be a literal string, a secret reference, or absent.\n\nIn TOML, this deserializes from:\n- Field absent: `None`\n- `field = \"literal-value\"`: `Some(Literal(\"literal-value\"))`\n- `field = { secret = \"SECRET_NAME\" }`: `Some(SecretRef { secret: \"SECRET_NAME\" })`"
    },
    "ProfileConfig": {
      "additionalProperties": false,
      "description": "Configuration for a profile",
      "properties": {
        "default_provider": {
          "anyOf": [
            {
              "$ref": "#/$defs/string"
            },
            {
              "type": "null"
            }
          ],
          "description": "Default provider name for this profile"
        },
        "providers": {
          "additionalProperties": {
            "$ref": "#/$defs/ProviderConfig"
          },
          "description": "Provider configurations for this profile",
          "type": "object"
        },
        "secrets": {
          "additionalProperties": {
            "$ref": "#/$defs/SecretConfig"
          },
          "description": "Secrets for this profile",
          "type": "object"
        }
      },
      "type": "object"
    },
    "ProviderConfig": {
      "oneOf": [
        {
          "additionalProperties": false,
          "properties": {
            "database": {
              "$ref": "#/$defs/StringOrSecretRef"
            },
            "keyfile": {
              "$ref": "#/$defs/OptionStringOrSecretRef"
            },
            "password": {
              "$ref": "#/$defs/OptionStringOrSecretRef"
            },
            "type": {
              "const": "keepass",
              "type": "string"
            }
          },
          "required": ["type", "database"],
          "type": "object"
        },
        {
          "additionalProperties": false,
          "properties": {
            "key_file": {
              "$ref": "#/$defs/OptionStringOrSecretRef"
            },
            "recipients": {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            "type": {
              "const": "age",
              "type": "string"
            }
          },
          "required": ["type", "recipients"],
          "type": "object"
        },
        {
          "additionalProperties": false,
          "properties": {
            "type": {
              "const": "plain",
              "type": "string"
            }
          },
          "required": ["type"],
          "type": "object"
        },
        {
          "additionalProperties": false,
          "properties": {
            "gpg_opts": {
              "$ref": "#/$defs/OptionStringOrSecretRef"
            },
            "prefix": {
              "$ref": "#/$defs/OptionStringOrSecretRef"
            },
            "store_dir": {
              "$ref": "#/$defs/OptionStringOrSecretRef"
            },
            "type": {
              "const": "password-store",
              "type": "string"
            }
          },
          "required": ["type"],
          "type": "object"
        },
        {
          "additionalProperties": false,
          "properties": {
            "account": {
              "$ref": "#/$defs/OptionStringOrSecretRef"
            },
            "token": {
              "$ref": "#/$defs/OptionStringOrSecretRef"
            },
            "type": {
              "const": "1password",
              "type": "string"
            },
            "vault": {
              "$ref": "#/$defs/OptionStringOrSecretRef"
            }
          },
          "required": ["type"],
          "type": "object"
        },
        {
          "additionalProperties": false,
          "properties": {
            "api_key": {
              "$ref": "#/$defs/OptionStringOrSecretRef"
            },
            "base_url": {
              "$ref": "#/$defs/StringOrSecretRef"
            },
            "password_list_id": {
              "$ref": "#/$defs/StringOrSecretRef"
            },
            "type": {
              "const": "passwordstate",
              "type": "string"
            },
            "verify_ssl": {
              "$ref": "#/$defs/OptionStringOrSecretRef"
            }
          },
          "required": ["type", "base_url", "password_list_id"],
          "type": "object"
        },
        {
          "additionalProperties": false,
          "properties": {
            "backend": {
              "anyOf": [
                {
                  "$ref": "#/$defs/BitwardenBackend"
                },
                {
                  "type": "null"
                }
              ]
            },
            "collection": {
              "$ref": "#/$defs/OptionStringOrSecretRef"
            },
            "organization_id": {
              "$ref": "#/$defs/OptionStringOrSecretRef"
            },
            "profile": {
              "$ref": "#/$defs/OptionStringOrSecretRef"
            },
            "type": {
              "const": "bitwarden",
              "type": "string"
            }
          },
          "required": ["type"],
          "type": "object"
        },
        {
          "additionalProperties": false,
          "properties": {
            "environment": {
              "$ref": "#/$defs/OptionStringOrSecretRef"
            },
            "path": {
              "$ref": "#/$defs/OptionStringOrSecretRef"
            },
            "project_id": {
              "$ref": "#/$defs/OptionStringOrSecretRef"
            },
            "type": {
              "const": "infisical",
              "type": "string"
            }
          },
          "required": ["type"],
          "type": "object"
        },
        {
          "additionalProperties": false,
          "properties": {
            "key_id": {
              "$ref": "#/$defs/StringOrSecretRef"
            },
            "region": {
              "$ref": "#/$defs/StringOrSecretRef"
            },
            "type": {
              "const": "aws-kms",
              "type": "string"
            }
          },
          "required": ["type", "key_id", "region"],
          "type": "object"
        },
        {
          "additionalProperties": false,
          "properties": {
            "key": {
              "$ref": "#/$defs/StringOrSecretRef"
            },
            "keyring": {
              "$ref": "#/$defs/StringOrSecretRef"
            },
            "location": {
              "$ref": "#/$defs/StringOrSecretRef"
            },
            "project": {
              "$ref": "#/$defs/StringOrSecretRef"
            },
            "type": {
              "const": "gcp-kms",
              "type": "string"
            }
          },
          "required": ["type", "project", "location", "keyring", "key"],
          "type": "object"
        },
        {
          "additionalProperties": false,
          "properties": {
            "key_name": {
              "$ref": "#/$defs/StringOrSecretRef"
            },
            "type": {
              "const": "azure-kms",
              "type": "string"
            },
            "vault_url": {
              "$ref": "#/$defs/StringOrSecretRef"
            }
          },
          "required": ["type", "vault_url", "key_name"],
          "type": "object"
        },
        {
          "additionalProperties": false,
          "properties": {
            "prefix": {
              "$ref": "#/$defs/OptionStringOrSecretRef"
            },
            "type": {
              "const": "azure-sm",
              "type": "string"
            },
            "vault_url": {
              "$ref": "#/$defs/StringOrSecretRef"
            }
          },
          "required": ["type", "vault_url"],
          "type": "object"
        },
        {
          "additionalProperties": false,
          "properties": {
            "prefix": {
              "$ref": "#/$defs/OptionStringOrSecretRef"
            },
            "region": {
              "$ref": "#/$defs/StringOrSecretRef"
            },
            "type": {
              "const": "aws-ps",
              "type": "string"
            }
          },
          "required": ["type", "region"],
          "type": "object"
        },
        {
          "additionalProperties": false,
          "properties": {
            "prefix": {
              "$ref": "#/$defs/OptionStringOrSecretRef"
            },
            "region": {
              "$ref": "#/$defs/StringOrSecretRef"
            },
            "type": {
              "const": "aws-sm",
              "type": "string"
            }
          },
          "required": ["type", "region"],
          "type": "object"
        },
        {
          "additionalProperties": false,
          "properties": {
            "address": {
              "$ref": "#/$defs/StringOrSecretRef"
            },
            "path": {
              "$ref": "#/$defs/OptionStringOrSecretRef"
            },
            "token": {
              "$ref": "#/$defs/OptionStringOrSecretRef"
            },
            "type": {
              "const": "vault",
              "type": "string"
            }
          },
          "required": ["type", "address"],
          "type": "object"
        },
        {
          "additionalProperties": false,
          "properties": {
            "prefix": {
              "$ref": "#/$defs/OptionStringOrSecretRef"
            },
            "project": {
              "$ref": "#/$defs/StringOrSecretRef"
            },
            "type": {
              "const": "gcp-sm",
              "type": "string"
            }
          },
          "required": ["type", "project"],
          "type": "object"
        },
        {
          "additionalProperties": false,
          "properties": {
            "prefix": {
              "$ref": "#/$defs/OptionStringOrSecretRef"
            },
            "service": {
              "$ref": "#/$defs/StringOrSecretRef"
            },
            "type": {
              "const": "keychain",
              "type": "string"
            }
          },
          "required": ["type", "service"],
          "type": "object"
        }
      ]
    },
    "SecretConfig": {
      "additionalProperties": false,
      "description": "Configuration for a single secret",
      "properties": {
        "default": {
          "description": "Default value to use if provider fails or secret is not found",
          "type": ["string", "null"]
        },
        "description": {
          "description": "Description of the secret",
          "type": ["string", "null"]
        },
        "if_missing": {
          "anyOf": [
            {
              "$ref": "#/$defs/IfMissing"
            },
            {
              "type": "null"
            }
          ],
          "description": "What to do if the secret is missing (error, warn, or ignore)"
        },
        "provider": {
          "anyOf": [
            {
              "$ref": "#/$defs/string"
            },
            {
              "type": "null"
            }
          ],
          "description": "Provider to fetch from (age, aws-kms, 1password, aws, etc.)"
        },
        "value": {
          "anyOf": [
            {
              "$ref": "#/$defs/string"
            },
            {
              "type": "null"
            }
          ],
          "description": "Value for the provider (secret name, encrypted blob, etc.)"
        }
      },
      "type": "object"
    },
    "StringOrSecretRef": {
      "description": "Either a literal string or a reference to a secret",
      "oneOf": [
        {
          "type": "string"
        },
        {
          "additionalProperties": false,
          "properties": {
            "secret": {
              "type": "string"
            }
          },
          "required": ["secret"],
          "type": "object"
        }
      ]
    },
    "string": {
      "type": "string"
    }
  },
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "additionalProperties": false,
  "properties": {
    "age_key_file": {
      "description": "Age encryption key file path (optional, can also be set via env var or CLI flag)",
      "type": ["string", "null"]
    },
    "default_provider": {
      "anyOf": [
        {
          "$ref": "#/$defs/string"
        },
        {
          "type": "null"
        }
      ],
      "description": "Default provider name for default profile"
    },
    "if_missing": {
      "anyOf": [
        {
          "$ref": "#/$defs/IfMissing"
        },
        {
          "type": "null"
        }
      ],
      "description": "Default if_missing behavior for all secrets in this config"
    },
    "import": {
      "description": "Import paths to other config files",
      "items": {
        "type": "string"
      },
      "type": "array"
    },
    "profiles": {
      "additionalProperties": {
        "$ref": "#/$defs/ProfileConfig"
      },
      "description": "Named profiles",
      "type": "object"
    },
    "prompt_auth": {
      "description": "Whether to prompt for authentication when provider auth fails (default: true in TTY)",
      "type": ["boolean", "null"]
    },
    "providers": {
      "additionalProperties": {
        "$ref": "#/$defs/ProviderConfig"
      },
      "description": "Provider configurations (for default profile)",
      "type": "object"
    },
    "root": {
      "description": "Root configuration - stops recursion at this level",
      "type": "boolean"
    },
    "secrets": {
      "additionalProperties": {
        "$ref": "#/$defs/SecretConfig"
      },
      "description": "Default profile secrets (top level)",
      "type": "object"
    }
  },
  "title": "Config",
  "type": "object"
}
